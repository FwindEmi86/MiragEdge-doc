<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-study/redis" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">rediså®¹å™¨æŠ€æœ¯ | é”ç•Œå¹»å¢ƒ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://f.windemiko.top/img/èƒŒæ™¯.jpg"><meta data-rh="true" name="twitter:image" content="https://f.windemiko.top/img/èƒŒæ™¯.jpg"><meta data-rh="true" property="og:url" content="https://f.windemiko.top/docs/study/redis"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="rediså®¹å™¨æŠ€æœ¯ | é”ç•Œå¹»å¢ƒ"><meta data-rh="true" name="description" content="é¢˜ç›®1: ä½¿ç”¨æä¾›çš„OpenStackç§æœ‰äº‘å¹³å°ï¼Œç”³è¯·ä¸‰å°CentOS7.9ç³»ç»Ÿçš„äº‘ä¸»æœºï¼Œä½¿ç”¨æä¾›çš„httpæºï¼Œåœ¨ä¸‰ä¸ªèŠ‚ç‚¹è‡ªè¡Œå®‰è£…RedisæœåŠ¡å¹¶å¯åŠ¨ï¼Œé…ç½®Redisçš„è®¿é—®éœ€è¦å¯†ç ï¼Œå¯†ç è®¾ç½®ä¸º123456ã€‚ç„¶åå°†è¿™ä¸‰ä¸ªRedisèŠ‚ç‚¹é…ç½®ä¸ºRedisçš„ä¸€ä¸»äºŒä»ä¸‰å“¨å…µæ¶æ„ï¼Œå³ä¸€ä¸ªRedisä¸»èŠ‚ç‚¹ï¼Œä¸¤ä¸ªä»èŠ‚ç‚¹ï¼Œä¸‰ä¸ªèŠ‚ç‚¹å‡ä¸ºå“¨å…µèŠ‚ç‚¹"><meta data-rh="true" property="og:description" content="é¢˜ç›®1: ä½¿ç”¨æä¾›çš„OpenStackç§æœ‰äº‘å¹³å°ï¼Œç”³è¯·ä¸‰å°CentOS7.9ç³»ç»Ÿçš„äº‘ä¸»æœºï¼Œä½¿ç”¨æä¾›çš„httpæºï¼Œåœ¨ä¸‰ä¸ªèŠ‚ç‚¹è‡ªè¡Œå®‰è£…RedisæœåŠ¡å¹¶å¯åŠ¨ï¼Œé…ç½®Redisçš„è®¿é—®éœ€è¦å¯†ç ï¼Œå¯†ç è®¾ç½®ä¸º123456ã€‚ç„¶åå°†è¿™ä¸‰ä¸ªRedisèŠ‚ç‚¹é…ç½®ä¸ºRedisçš„ä¸€ä¸»äºŒä»ä¸‰å“¨å…µæ¶æ„ï¼Œå³ä¸€ä¸ªRedisä¸»èŠ‚ç‚¹ï¼Œä¸¤ä¸ªä»èŠ‚ç‚¹ï¼Œä¸‰ä¸ªèŠ‚ç‚¹å‡ä¸ºå“¨å…µèŠ‚ç‚¹"><link data-rh="true" rel="icon" href="/img/B-LOGO.ico"><link data-rh="true" rel="canonical" href="https://f.windemiko.top/docs/study/redis"><link data-rh="true" rel="alternate" href="https://f.windemiko.top/docs/study/redis" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://f.windemiko.top/docs/study/redis" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"redisæ•°æ®åº“æŠ€æœ¯","item":"https://f.windemiko.top/docs/study/redis"}]}</script><link rel="stylesheet" href="/assets/css/styles.9ba1c3ba.css">
<script src="/assets/js/runtime~main.7ad96a82.js" defer="defer"></script>
<script src="/assets/js/main.1ff08c05.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","dark"),document.documentElement.setAttribute("data-theme-choice","dark"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/B-LOGO.svg"><div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav aria-label="ä¸»å¯¼èˆª" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/B-LOGO.svg" alt="MiragEdge" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/B-LOGO.svg" alt="MiragEdge" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MiragEdge</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://miragedge.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">å®˜ç½‘<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">æ–‡æ¡£</a><a href="https://space.bilibili.com/359174372" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Bç«™ä¸»é¡µ<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="æœç´¢" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1">
        <div class="sidebar-header">
          <div class="logo-wrap">
            <i class="logo-icon"></i>
          </div>
          <h2 class="sidebar-title">é”ç•Œå¹»å¢ƒæ–‡æ¡£</h2>
        </div>
      </li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider wave"></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-main-item"><a class="menu__link" href="/docs/intro"><span title="ğŸ“œ æ–‡æ¡£å‰è¨€" class="linkLabel_WmDU">ğŸ“œ æ–‡æ¡£å‰è¨€</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-main-item"><a class="menu__link" href="/docs/review"><span title="ğŸ›¡ï¸ ç©å®¶å®¡æ ¸" class="linkLabel_WmDU">ğŸ›¡ï¸ ç©å®¶å®¡æ ¸</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider dotted"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-category rule-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/ServerRule"><span title="ğŸ” ç¤¾åŒºè§„åˆ™" class="categoryLinkLabel_W154">ğŸ” ç¤¾åŒºè§„åˆ™</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider gradient"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-category tutorial-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/tutorial/BackGround"><span title="ğŸ® æ–°æ‰‹æ•™ç¨‹" class="categoryLinkLabel_W154">ğŸ® æ–°æ‰‹æ•™ç¨‹</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial/BackGround"><span title="ğŸ’– èƒŒæ™¯ä»‹ç»" class="linkLabel_WmDU">ğŸ’– èƒŒæ™¯ä»‹ç»</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed sidebar-category tutorial-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/tutorial/ClientInstall"><span title="ğŸŒ åŠ å…¥æœåŠ¡å™¨" class="categoryLinkLabel_W154">ğŸŒ åŠ å…¥æœåŠ¡å™¨</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial/gameplay"><span title="âš”ï¸ æ ¸å¿ƒç©æ³•" class="linkLabel_WmDU">âš”ï¸ æ ¸å¿ƒç©æ³•</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider dotted"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-category gameplay-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/gameplay/CustomCroups"><span title="ğŸ² è¿›é˜¶ç©æ³•" class="categoryLinkLabel_W154">ğŸ² è¿›é˜¶ç©æ³•</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider gradient"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-category faq-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/question/Game"><span title="â“ å¸¸è§é—®é¢˜" class="categoryLinkLabel_W154">â“ å¸¸è§é—®é¢˜</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item changelog-item"><a class="menu__link" href="/docs/log"><span title="ğŸ“… æ›´æ–°æ—¥å¿—" class="linkLabel_WmDU">ğŸ“… æ›´æ–°æ—¥å¿—</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider dotted"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-category faq-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/develop/intro"><span title="ğŸ¨ å¼€å‘æ–‡æ¡£" class="categoryLinkLabel_W154">ğŸ¨ å¼€å‘æ–‡æ¡£</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider dotted"></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-category faq-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/study/Docker"><span title="ğŸ« æŠ€æœ¯å­¦ä¹ " class="categoryLinkLabel_W154">ğŸ« æŠ€æœ¯å­¦ä¹ </span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/study/Docker"><span title="Dockerå®¹å™¨æŠ€æœ¯" class="linkLabel_WmDU">Dockerå®¹å™¨æŠ€æœ¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/study/Kubernetes"><span title="k8så®¹å™¨ç¼–æ’æŠ€æœ¯" class="linkLabel_WmDU">k8så®¹å™¨ç¼–æ’æŠ€æœ¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/study/redis"><span title="redisæ•°æ®åº“æŠ€æœ¯" class="linkLabel_WmDU">redisæ•°æ®åº“æŠ€æœ¯</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><div class="divider wave"></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1">
        <div class="external-links">
          <a class="external-link" href="https://miragedge.top">ğŸŒ å®˜æ–¹ç½‘ç«™</a>
        </div>
      </li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ğŸ« æŠ€æœ¯å­¦ä¹ </span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">redisæ•°æ®åº“æŠ€æœ¯</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>rediså®¹å™¨æŠ€æœ¯</h1></header><p><strong>é¢˜ç›®1:</strong> ä½¿ç”¨æä¾›çš„OpenStackç§æœ‰äº‘å¹³å°ï¼Œç”³è¯·ä¸‰å°CentOS7.9ç³»ç»Ÿçš„äº‘ä¸»æœºï¼Œä½¿ç”¨æä¾›çš„httpæºï¼Œåœ¨ä¸‰ä¸ªèŠ‚ç‚¹è‡ªè¡Œå®‰è£…RedisæœåŠ¡å¹¶å¯åŠ¨ï¼Œé…ç½®Redisçš„è®¿é—®éœ€è¦å¯†ç ï¼Œå¯†ç è®¾ç½®ä¸º123456ã€‚ç„¶åå°†è¿™ä¸‰ä¸ªRedisèŠ‚ç‚¹é…ç½®ä¸ºRedisçš„ä¸€ä¸»äºŒä»ä¸‰å“¨å…µæ¶æ„ï¼Œå³ä¸€ä¸ªRedisä¸»èŠ‚ç‚¹ï¼Œä¸¤ä¸ªä»èŠ‚ç‚¹ï¼Œä¸‰ä¸ªèŠ‚ç‚¹å‡ä¸ºå“¨å…µèŠ‚ç‚¹</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-rediså“¨å…µæ¨¡å¼æœåŠ¡ä»‹ç»">1. Rediså“¨å…µæ¨¡å¼æœåŠ¡ä»‹ç»<a href="#1-rediså“¨å…µæ¨¡å¼æœåŠ¡ä»‹ç»" class="hash-link" aria-label="1. Rediså“¨å…µæ¨¡å¼æœåŠ¡ä»‹ç»çš„ç›´æ¥é“¾æ¥" title="1. Rediså“¨å…µæ¨¡å¼æœåŠ¡ä»‹ç»çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>ï¼ˆ1ï¼‰å“¨å…µæ¨¡å¼æ¦‚è¿°</p>
<p>åœ¨è¯´å“¨å…µä¹‹å‰ï¼Œå…ˆè¯´ä¸‹ä¸»ä»å¤åˆ¶ï¼ŒRedisçš„ä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œä¸€æ—¦ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœæ— æ³•æä¾›æœåŠ¡ï¼Œéœ€è¦äººå·¥ä»‹å…¥æ‰‹å·¥å°†ä»èŠ‚ç‚¹è°ƒæ•´ä¸ºä¸»èŠ‚ç‚¹ï¼ŒåŒæ—¶åº”ç”¨ç«¯è¿˜éœ€è¦ä¿®æ”¹æ–°çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚è¿™ç§æ•…éšœè½¬ç§»çš„æ–¹å¼å¯¹äºå¾ˆå¤šåº”ç”¨åœºæ™¯æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚æ­£å¼ç”±äºè¿™ä¸ªé—®é¢˜ï¼ŒRedisæä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>Redis Sentinelæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ¶æ„ï¼Œå®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„RedisèŠ‚ç‚¹ï¼Œä½†æ˜¯å®ƒä¸å­˜å‚¨æ•°æ®ï¼Œåªæ”¯æŒéƒ¨åˆ†å‘½ä»¤ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨å®Œæˆæ•…éšœå‘ç°å’Œæ•…éšœè½¬ç§»ï¼Œå¹¶é€šçŸ¥åº”ç”¨æ–¹ï¼Œä»è€Œå®ç°é«˜å¯ç”¨ã€‚</p>
<p>Redis Sentinel åŒ…å«è‹¥å¹²ä¸ªSentinelèŠ‚ç‚¹å’ŒRedisæ•°æ®èŠ‚ç‚¹ï¼Œæ¯ä¸ªSentinelèŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å’Œå…¶ä»–SentinelèŠ‚ç‚¹è¿›è¡Œç›‘æ§ã€‚å½“å‘ç°èŠ‚ç‚¹å¼‚å¸¸æ—¶ï¼Œä¼šå¯¹èŠ‚ç‚¹åšä¸‹çº¿æ ‡è¯†ï¼Œå¦‚æœè¢«æ ‡è¯†çš„æ˜¯ä¸»èŠ‚ç‚¹ï¼Œæ­¤æ—¶ä¼šä¸å…¶ä»–SentinelèŠ‚ç‚¹è¿›è¡Œåå•†ï¼Œå½“å¤§å¤šæ•°SentinelèŠ‚ç‚¹éƒ½è®¤ä¸ºä¸»èŠ‚ç‚¹ä¸å¯è¾¾æ—¶å€™ï¼Œä¼šå‘èµ·é€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ª Sentinel èŠ‚ç‚¹æ¥å®Œæˆè‡ªåŠ¨æ•…éšœè½¬ç§»çš„å·¥ä½œï¼ŒåŒæ—¶ä¼šå°†è¿™ä¸ªå˜åŒ–é€šçŸ¥ç»™Redisçš„åº”ç”¨æ–¹ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚</p>
<p>ï¼ˆ2ï¼‰å“¨å…µæ¨¡å¼ä¸»è¦åŠŸèƒ½</p>
<p>Sentinel ä¸»è¦æä¾›ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li class="">ç›‘æ§ï¼šå®šæœŸæ£€æµ‹Redisæ•°æ®èŠ‚ç‚¹ã€å…¶ä»–SentinelèŠ‚ç‚¹æ˜¯å¦å¯è¾¾ã€‚</li>
<li class="">é€šçŸ¥ï¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹ã€‚</li>
<li class="">ä¸»èŠ‚ç‚¹æ•…éšœè½¬ç§»ï¼šå®ç°ä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹ï¼Œå¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³»ã€‚</li>
<li class="">é…ç½®æä¾›è€…ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¿æ¥SentinelèŠ‚ç‚¹é›†åˆï¼Œä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯ã€‚</li>
</ul>
<p>å¤šä¸ªSentinelèŠ‚ç‚¹æ¥å…±åŒåˆ¤æ–­æ•…éšœï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢è¯¯åˆ¤ï¼ŒåŒæ—¶å¦‚æœä¸ªåˆ«SentinelèŠ‚ç‚¹ä¸å¯ç”¨ï¼Œæ•´ä¸ªSentinelèŠ‚ç‚¹é›†åˆä¾ç„¶æ˜¯é«˜å¯ç”¨çš„ã€‚</p>
<p>ï¼ˆ3ï¼‰å“¨å…µæ¨¡å¼å·¥ä½œæµç¨‹</p>
<p>Sentinelæ˜¯Redisçš„é«˜å¯ç”¨æ€§è§£å†³æ–¹æ¡ˆï¼š</p>
<p>ç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ï¼Œä»¥åŠæ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå¹¶åœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çŠ¶æ€æ—¶ï¼Œè‡ªåŠ¨å°†ä¸‹çº¿ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œç„¶åç”±æ–°çš„ä¸»æœåŠ¡å™¨ä»£æ›¿å·²ä¸‹çº¿çš„ä¸»æœåŠ¡å™¨ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚</p>
<p>Sentinelè´Ÿè´£ç›‘æ§é›†ç¾¤ä¸­çš„æ‰€æœ‰ä¸»ã€ä»Redisï¼Œå½“å‘ç°ä¸»æ•…éšœæ—¶ï¼ŒSentinelä¼šåœ¨æ‰€æœ‰çš„ä»ä¸­é€‰ä¸€ä¸ªæˆä¸ºæ–°çš„ä¸»ã€‚å¹¶ä¸”ä¼šæŠŠå…¶ä½™çš„ä»å˜ä¸ºæ–°ä¸»çš„ä»ã€‚åŒæ—¶é‚£å°æœ‰é—®é¢˜çš„æ—§ä¸»ä¹Ÿä¼šå˜ä¸ºæ–°ä¸»çš„ä»ï¼Œå³å½“æ—§çš„ä¸»å³ä½¿æ¢å¤æ—¶ï¼Œå¹¶ä¸ä¼šæ¢å¤åŸæ¥çš„ä¸»èº«ä»½ï¼Œè€Œæ˜¯ä½œä¸ºæ–°ä¸»çš„ä¸€ä¸ªä»ã€‚</p>
<p>åœ¨Redisé«˜å¯ç”¨æ¶æ„ä¸­ï¼ŒSentinelå¾€å¾€ä¸æ˜¯åªæœ‰ä¸€ä¸ªï¼Œè€Œæ˜¯æœ‰ä¸‰ä¸ªæˆ–è€…ä»¥ä¸Šã€‚ç›®çš„æ˜¯ä¸ºäº†è®©å…¶æ›´åŠ å¯é ï¼Œæ¯•ç«Ÿä¸»å’Œä»åˆ‡æ¢è§’è‰²è¿™ä¸ªè¿‡ç¨‹è¿˜æ˜¯è›®å¤æ‚çš„ã€‚</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-rediså“¨å…µæ¨¡å¼æœåŠ¡æ¡ˆä¾‹å®ç°">2. Rediså“¨å…µæ¨¡å¼æœåŠ¡æ¡ˆä¾‹å®ç°<a href="#2-rediså“¨å…µæ¨¡å¼æœåŠ¡æ¡ˆä¾‹å®ç°" class="hash-link" aria-label="2. Rediså“¨å…µæ¨¡å¼æœåŠ¡æ¡ˆä¾‹å®ç°çš„ç›´æ¥é“¾æ¥" title="2. Rediså“¨å…µæ¨¡å¼æœåŠ¡æ¡ˆä¾‹å®ç°çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>ï¼ˆ1ï¼‰ä¸€ä¸»äºŒä»Redisé›†ç¾¤éƒ¨ç½²</p>
<p>ä½¿ç”¨SSHå·¥å…·è¿æ¥ä¸‰ä¸ªè™šæ‹ŸæœºèŠ‚ç‚¹ä¿®æ”¹ä¸»æœºåã€‚å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>redis1ä¸»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@localhost ~]# hostnamectl set-hostname redis1</span><br></span></code></pre></div></div>
<p>redis2ä»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@localhost ~]# hostnamectl set-hostname redis2</span><br></span></code></pre></div></div>
<p>redis3ä»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@localhost ~]# hostnamectl set-hostname redis3</span><br></span></code></pre></div></div>
<p>ä¿®æ”¹ä¸»æœºåå®Œæˆåï¼Œéœ€è¦é‡æ–°è¿æ¥ä¸»æœºã€‚</p>
<p>å°†æä¾›çš„Rediså®‰è£…æ–‡ä»¶ä¸‹è½½redis-3.2.12.tar.gzåˆ°ä¸‰å°è™šæ‹Ÿæœºä¸­ï¼Œè§£å‹åˆ°/optç›®å½•ä¸­ï¼Œå¹¶é…ç½®yumæºä½¿ç”¨æœ¬åœ°ç›®å½•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼ˆä¸‰å°è™šæ‹Ÿæœºæ“ä½œä¸€è‡´ï¼Œä»¥redis1ä¸»æœºä¸ºä¾‹ï¼‰ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# curl -O http://mirrors.54mc.cn/competition/redis-3.2.12.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# tar -xf redis-3.2.12.tar.gz -C /opt/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# mv /etc/yum.repos.d/* /media/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# cat &lt;&lt; EOF &gt;&gt; /etc/yum.repos.d/redis.repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[redis]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name=redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">baseurl=file:///opt/redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# yum clean all &amp;&amp; yum repolist</span><br></span></code></pre></div></div>
<p>åœ¨ä¸‰ä¸ªèŠ‚ç‚¹ä½¿ç”¨yumå‘½ä»¤å®‰è£…RedisæœåŠ¡å¹¶å¯åŠ¨ã€‚å‘½ä»¤å¦‚ä¸‹ï¼ˆä¸‰å°è™šæ‹Ÿæœºæ“ä½œä¸€è‡´ï¼Œä»¥redis1ä¸»æœºä¸ºä¾‹ï¼‰ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# yum install -y redis </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â€¦ â€¦</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Complete!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl start redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl enable redis</span><br></span></code></pre></div></div>
<p>æŒ‰ç…§ä¸»ä»Redisé…ç½®ï¼Œå°†redis2èŠ‚ç‚¹å’Œredis3èŠ‚ç‚¹ä½œä¸ºredis1èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ã€‚é…ç½®å®Œæˆåçš„ä¸€ä¸»äºŒä»Redisé›†ç¾¤å°†ä½œä¸ºå“¨å…µæ¨¡å¼çš„åŸºç¡€ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<p>redis1èŠ‚ç‚¹ï¼š</p>
<p>ä¿®æ”¹redis1èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶/etc/redis.confå¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# vi /etc/redis.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸€å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind 0.0.0.0                    //æ‰¾åˆ°bind 127.0.0.1è¿™è¡Œå¹¶ä¿®æ”¹ä¸º0.0.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äºŒå¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected-mode no                //å°†yesä¿®æ”¹ä¸ºnoï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥è®¿é—®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸‰å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemonize yes                       //å°†noä¿®æ”¹ä¸ºyesï¼Œå¼€å¯å®ˆæŠ¤è¿›ç¨‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å››å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">requirepass &quot;123456&quot;                   //æ·»åŠ è®¾ç½®è®¿é—®å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äº”å¤„ä¿®æ”¹ï¼Œè®¾å®šä¸»åº“å¯†ç ä¸å½“å‰åº“å¯†ç åŒæ­¥ï¼Œä¿è¯ä»åº“èƒ½å¤Ÿæå‡ä¸ºä¸»åº“</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">masterauth &quot;123456&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å…­å¤„ä¿®æ”¹ï¼Œå°†noä¿®æ”¹ä¸ºyesï¼Œæ‰“å¼€AOFæŒä¹…åŒ–æ”¯æŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">appendonly yes</span><br></span></code></pre></div></div>
<p>è‡³æ­¤ï¼Œredis1ä¸»èŠ‚ç‚¹é…ç½®å®Œæ¯•ï¼Œé‡å¯æœåŠ¡ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl restart redis</span><br></span></code></pre></div></div>
<p>redis2èŠ‚ç‚¹ï¼š</p>
<p>ä¿®æ”¹redis2èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶/etc/redis.confå¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis2 ~]# vi /etc/redis.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸€å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind 0.0.0.0                    //æ‰¾åˆ°bind 127.0.0.1è¿™è¡Œå¹¶ä¿®æ”¹ä¸º0.0.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äºŒå¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected-mode no                    //å°†yesä¿®æ”¹ä¸ºnoï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥è®¿é—®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸‰å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemonize yes                       //å°†noä¿®æ”¹ä¸ºyesï¼Œå¼€å¯å®ˆæŠ¤è¿›ç¨‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å››å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># requirepass foobared                 //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">requirepass &quot;123456&quot;                   //åœ¨ä¸‹æ–¹æ·»åŠ è®¾ç½®è®¿é—®å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äº”å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># slaveof &lt;masterip&gt; &lt;masterport&gt;       //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slaveof 192.168.200.21 6379          //åœ¨ä¸‹æ–¹æ·»åŠ è®¿é—®çš„ä¸»èŠ‚ç‚¹IPä¸ç«¯å£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å…­å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># masterauth &lt;master-password&gt;        //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">masterauth &quot;123456&quot;                   //åœ¨ä¸‹æ–¹æ·»åŠ è®¿é—®ä¸»èŠ‚ç‚¹å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸ƒå¤„ä¿®æ”¹ï¼Œå°†noä¿®æ”¹ä¸ºyesï¼Œæ‰“å¼€AOFæŒä¹…åŒ–æ”¯æŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">appendonly yes</span><br></span></code></pre></div></div>
<p>è‡³æ­¤ï¼Œredis2ä¸»èŠ‚ç‚¹é…ç½®å®Œæ¯•ï¼Œé‡å¯æœåŠ¡ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis2 ~]# systemctl restart redis</span><br></span></code></pre></div></div>
<p>é…ç½®redis3èŠ‚ç‚¹ï¼š</p>
<p>ä¿®æ”¹redis3èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶/etc/redis.confå¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis3 ~]# vi /etc/redis.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸€å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind 0.0.0.0                    //æ‰¾åˆ°bind 127.0.0.1è¿™è¡Œå¹¶ä¿®æ”¹ä¸º0.0.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äºŒå¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected-mode no                    //å°†yesä¿®æ”¹ä¸ºnoï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥è®¿é—®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸‰å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemonize yes                       //å°†noä¿®æ”¹ä¸ºyesï¼Œå¼€å¯å®ˆæŠ¤è¿›ç¨‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å››å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># requirepass foobared                 //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">requirepass &quot;123456&quot;                   //åœ¨ä¸‹æ–¹æ·»åŠ è®¾ç½®è®¿é—®å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äº”å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># slaveof &lt;masterip&gt; &lt;masterport&gt;       //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slaveof 192.168.200.21 6379          //åœ¨ä¸‹æ–¹æ·»åŠ è®¿é—®çš„ä¸»èŠ‚ç‚¹IPä¸ç«¯å£</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å…­å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># masterauth &lt;master-password&gt;        //æ‰¾åˆ°è¯¥è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">masterauth &quot;123456&quot;                   //åœ¨ä¸‹æ–¹æ·»åŠ è®¿é—®ä¸»èŠ‚ç‚¹å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸ƒå¤„ä¿®æ”¹ï¼Œå°†noä¿®æ”¹ä¸ºyesï¼Œæ‰“å¼€AOFæŒä¹…åŒ–æ”¯æŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">appendonly yes</span><br></span></code></pre></div></div>
<p>è‡³æ­¤ï¼Œredis3ä¸»èŠ‚ç‚¹é…ç½®å®Œæ¯•ï¼Œé‡å¯æœåŠ¡ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis3 ~]# systemctl restart redis</span><br></span></code></pre></div></div>
<p>è¿™æ ·ä¸€ä¸»äºŒä»Redisé›†ç¾¤éƒ¨ç½²å°±å®Œæˆäº†ï¼Œä¸€ä¸»äºŒä»Redisé›†ç¾¤éƒ¨ç½²å®Œæˆåï¼Œç°åœ¨åœ¨æ¯ä¸ªèŠ‚ç‚¹æŸ¥è¯¢èŠ‚ç‚¹redisæœåŠ¡ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>redis1ä¸»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# redis-cli -h 192.168.200.21 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave0:ip=192.168.200.22,port=6379,state=online,offset=9383,lag=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave1:ip=192.168.200.23,port=6379,state=online,offset=9238,lag=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:9383</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:9382</span><br></span></code></pre></div></div>
<p>redis2ä»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis2 ~]# redis-cli -h 192.168.200.22 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:slave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_host:192.168.200.21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_port:6379</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_link_status:up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_last_io_seconds_ago:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_sync_in_progress:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_repl_offset:2648</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_priority:100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_read_only:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:0</span><br></span></code></pre></div></div>
<p>redis3ä»èŠ‚ç‚¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis3 ~]# redis-cli -h 192.168.200.23 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:slave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_host:192.168.200.21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_port:6379</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_link_status:up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_last_io_seconds_ago:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_sync_in_progress:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_repl_offset:8658</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_priority:100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_read_only:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:0</span><br></span></code></pre></div></div>
<p>ï¼ˆ2ï¼‰Rediså“¨å…µæ¨¡å¼é…ç½®</p>
<p>ä¿®æ”¹ä¸€ä¸»äºŒä»redisé›†ç¾¤å„èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶ï¼Œå®Œæˆrediså“¨å…µæ¨¡å¼çš„é…ç½®ã€‚</p>
<p>redis1èŠ‚ç‚¹ï¼š</p>
<p>ä¿®æ”¹redis1èŠ‚ç‚¹çš„/etc/redis-sentinel.confé…ç½®æ–‡ä»¶ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# vi /etc/redis-sentinel.conf </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 1. ä¿æŠ¤æ¨¡å¼ä¿®æ”¹ä¸ºå¦ï¼Œå…è®¸è¿œç¨‹è¿æ¥</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected-mode no</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 2. ä¿®æ”¹ç›‘æ§åœ°å€ï¼Œä¸ºä¸»redisåº“çš„ä¸»æœºipåœ°å€</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel monitor mymaster 192.168.200.21 6379 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 3. æ·»åŠ é…ç½®5ç§’å†…æ²¡æœ‰å“åº”ï¼Œå°±åé¦ˆæœåŠ¡å™¨æŒ‚äº†</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel down-after-milliseconds mymaster 5000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 4. ä¿®æ”¹é…ç½®15ç§’å†…masteræ²¡æœ‰æ´»èµ·æ¥ï¼Œå°±é‡æ–°é€‰ä¸¾ä¸»</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel failover-timeout mymaster 15000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 5. è¡¨ç¤ºå¦‚æœmasteré‡æ–°é€‰å‡ºæ¥åï¼Œå…¶å®ƒslaveèŠ‚ç‚¹èƒ½åŒæ—¶å¹¶è¡Œä»æ–°masteråŒæ­¥ç¼“å­˜çš„å°æ•°æœ‰å¤šå°‘ä¸ªï¼Œæ˜¾ç„¶è¯¥å€¼è¶Šå¤§ï¼Œæ‰€æœ‰slaveèŠ‚ç‚¹å®ŒæˆåŒæ­¥åˆ‡æ¢çš„æ•´ä½“é€Ÿåº¦è¶Šå¿«ï¼Œä½†å¦‚æœæ­¤æ—¶æ­£å¥½æœ‰äººåœ¨è®¿é—®è¿™äº›slaveï¼Œå¯èƒ½é€ æˆè¯»å–å¤±è´¥ï¼Œå½±å“é¢ä¼šæ›´å¹¿ã€‚æœ€å®‰å…¨çš„è®¾ç½®ä¸º1ï¼ŒåªåŒä¸€æ—¶é—´ï¼Œåªèƒ½æœ‰ä¸€å°å¹²è¿™ä»¶äº‹ï¼Œè¿™æ ·å…¶å®ƒslaveè¿˜èƒ½ç»§ç»­æœåŠ¡ï¼Œä½†æ˜¯æ‰€æœ‰slaveå…¨éƒ¨å®Œæˆç¼“å­˜æ›´æ–°åŒæ­¥çš„è¿›ç¨‹å°†å˜æ…¢ã€‚è¿™é‡Œè®¾ç½®ä¸º2ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel parallel-syncs mymaster 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 6. æ·»åŠ é…ç½®ä¸»æ•°æ®åº“å¯†ç ä¸º123456</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel auth-pass mymaster 123456</span><br></span></code></pre></div></div>
<p>ä¿®æ”¹redis2ä»èŠ‚ç‚¹å’Œredis3ä»èŠ‚ç‚¹çš„/etc/redis-sentinel.confé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹ä¸redis1ä¸»èŠ‚ç‚¹çš„/etc/redis-sentinel.confé…ç½®æ–‡ä»¶ä¸€è‡´ã€‚</p>
<p>ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åï¼Œå“¨å…µæ¨¡å¼é…ç½®å°±å®Œæ¯•äº†ï¼Œæ¥ä¸‹æ¥éœ€è¦é‡å¯æœåŠ¡ã€‚å› ä¸ºRedisæœåŠ¡å·²ç»å¯åŠ¨ï¼Œç°åœ¨åªéœ€è¦å¯åŠ¨Rediså“¨å…µæœåŠ¡ã€‚å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>æ‰€æœ‰èŠ‚ç‚¹å¯åŠ¨å“¨å…µï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl restart redis-sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl enable redis-sentinel</span><br></span></code></pre></div></div>
<p>ï¼ˆ3ï¼‰å“¨å…µæ¨¡å¼ä¿¡æ¯æŸ¥çœ‹</p>
<p>åœ¨redis1èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹å“¨å…µæ¨¡å¼ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# redis-cli -h 192.168.200.21 -p 26379 INFO Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_masters:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_tilt:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_running_scripts:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_scripts_queue_length:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_simulate_failure_flags:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master0:name=mymaster,status=ok,address=192.168.200.21:6379,slaves=2,sentinels=3</span><br></span></code></pre></div></div>
<p>åœ¨redis2èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹å“¨å…µæ¨¡å¼ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis2 ~]# redis-cli -h 192.168.200.22 -p 26379 INFO Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_masters:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_tilt:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_running_scripts:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_scripts_queue_length:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_simulate_failure_flags:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master0:name=mymaster,status=ok,address=192.168.200.21:6379,slaves=2,sentinels=3</span><br></span></code></pre></div></div>
<p>åœ¨redis3èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹å“¨å…µæ¨¡å¼ä¿¡æ¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis3 ~]# redis-cli -h 192.168.200.23 -p 26379 INFO Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_masters:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_tilt:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_running_scripts:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_scripts_queue_length:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sentinel_simulate_failure_flags:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master0:name=mymaster,status=ok,address=192.168.200.21:6379,slaves=2,sentinels=3</span><br></span></code></pre></div></div>
<p>å¯ä»¥çœ‹åˆ°ç›®å‰é›†ç¾¤ä¸­æœ‰ä¸€ä¸ªRedisä¸»èŠ‚ç‚¹ï¼Œä¸¤ä¸ªRedisä»èŠ‚ç‚¹ï¼Œä¸‰ä¸ªå“¨å…µèŠ‚ç‚¹ã€‚</p>
<p>ï¼ˆ4ï¼‰å“¨å…µæ¨¡å¼éªŒè¯</p>
<p>å“¨å…µä½œä¸ºå¯¹Rediså®ä¾‹çš„ç›‘æ§ï¼Œé€šè¿‡é€‰ä¸¾ç®—æ³•ä¿è¯å“¨å…µçš„é²æ£’æ€§å’Œé«˜å¯ç”¨ï¼Œæ‰€ä»¥å“¨å…µè‡³å°‘è¦éƒ¨ç½²3å°ï¼Œç¬¦åˆåŠæ•°åŸåˆ™ï¼Œéœ€è¦5æˆ–è€…7ï¼Œè¶…è¿‡ä¸€åŠï¼Œä¸åŒ…å«ä¸€åŠå­˜æ´»çš„æ—¶å€™ï¼Œæ‰èƒ½å¤Ÿé€‰ä¸¾å‡ºleaderï¼Œæ‰èƒ½è¿›è¡Œä¸»ä»çš„åˆ‡æ¢åŠŸèƒ½ã€‚</p>
<p>å“¨å…µé«˜å¯ç”¨æµ‹è¯•ï¼šåˆ†åˆ«è¿æ¥å¯¹åº”çš„RedisæœåŠ¡ç«¯ï¼Œæ‰‹åŠ¨åœæ­¢ä¸»ReidsæœåŠ¡ï¼Œçœ‹ä¸»ä»æ˜¯å¦åˆ‡æ¢æˆåŠŸã€‚</p>
<p>redis1èŠ‚ç‚¹ï¼Œæ‰‹åŠ¨åœæ­¢æœåŠ¡ï¼Œç„¶åæŸ¥çœ‹ä¸»èŠ‚ç‚¹æ˜¯å¦åˆ‡æ¢ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl stop redis</span><br></span></code></pre></div></div>
<p>åˆ‡æ¢åˆ°redis2èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹Redisé›†ç¾¤çš„ä¸»ä»ä¿¡æ¯ï¼ˆè®¿é—®reids2èŠ‚ç‚¹çš„RedisæœåŠ¡ï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼ˆredisä¸»èŠ‚ç‚¹éšæœºåˆ‡æ¢åˆ°ä»èŠ‚ç‚¹ï¼‰ï¼š</p>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis2 ~]# redis-cli -h 192.168.200.22 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:slave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_host:192.168.200.23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_port:6379</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_link_status:up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_last_io_seconds_ago:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_sync_in_progress:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_repl_offset:6591</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_priority:100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_read_only:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:0</span><br></span></code></pre></div></div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œredis2èŠ‚ç‚¹çš„master_hostå˜æˆäº†192.168.200.23ï¼Œä¹Ÿå°±æ˜¯è¯´redis3èŠ‚ç‚¹å˜æˆäº†ä¸»èŠ‚ç‚¹ã€‚</p>
<p>ç„¶ååˆ‡æ¢åˆ°redis3èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹Redisé›†ç¾¤çš„ä¸»ä»ä¿¡æ¯ï¼ˆè®¿é—®reids3èŠ‚ç‚¹çš„RedisæœåŠ¡ï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis3 ~]# redis-cli -h 192.168.200.23 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave0:ip=192.168.200.22,port=6379,state=online,offset=7461,lag=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:7461</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:7460</span><br></span></code></pre></div></div>
<p>redis3èŠ‚ç‚¹æˆåŠŸåˆ‡æ¢æˆäº†ä¸»èŠ‚ç‚¹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¸»èŠ‚ç‚¹å‘ç”Ÿäº†å®•æœºï¼Œå…¶ä»–çš„ä»èŠ‚ç‚¹å¯ä»¥è‡ªåŠ¨åˆ‡æ¢æˆä¸»èŠ‚ç‚¹ã€‚</p>
<p>åˆ‡æ¢åˆ°redis1èŠ‚ç‚¹ï¼Œå¯åŠ¨æ¢å¤RedisæœåŠ¡ï¼ŒæŸ¥çœ‹redisé›†ç¾¤çš„ä¸»ä»ä¿¡æ¯ï¼ˆè®¿é—®reids1èŠ‚ç‚¹çš„RedisæœåŠ¡ï¼‰ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl restart redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# systemctl restart redis-sentinel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis1 ~]# redis-cli -h 192.168.200.21 -p 6379 -a 123456 info replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Replication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">role:slave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_host:192.168.200.23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_port:6379</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_link_status:up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_last_io_seconds_ago:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_sync_in_progress:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_repl_offset:103524</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_priority:100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">slave_read_only:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connected_slaves:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">master_repl_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_active:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_size:1048576</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_first_byte_offset:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repl_backlog_histlen:0</span><br></span></code></pre></div></div>
<p>å¯ä»¥çœ‹è§redis1èŠ‚ç‚¹å˜æˆäº†ä»èŠ‚ç‚¹ã€‚Rediså“¨å…µæ¨¡å¼çš„éªŒè¯æˆåŠŸã€‚</p>
<p><strong>é¢˜ç›®2ï¼š</strong>
Redis AOFè°ƒä¼˜
ä¿®æ”¹åœ¨Redisç›¸å…³é…ç½®ï¼Œé¿å…AOFæ–‡ä»¶è¿‡å¤§ï¼ŒRedisä¼šè¿›è¡ŒAOFé‡å†™</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@localhost ~]# hostnamectl set-hostname redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# curl -O http://mirrors.54mc.cn/competition/redis-3.2.12.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# tar -xf redis-3.2.12.tar.gz -C /opt/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# mv /etc/yum.repos.d/* /media/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# cat &lt;&lt; EOF &gt;&gt; /etc/yum.repos.d/redis.repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[redis]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name=redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">baseurl=file:///opt/redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gpgcheck=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# yum clean all &amp;&amp; yum repolist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# yum install -y redis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@redis ~]# vi /etc/redis.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸€å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bind 0.0.0.0                    //æ‰¾åˆ°bind 127.0.0.1è¿™è¡Œå¹¶ä¿®æ”¹ä¸º0.0.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äºŒå¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected-mode no                //å°†yesä¿®æ”¹ä¸ºnoï¼Œå¤–éƒ¨ç½‘ç»œå¯ä»¥è®¿é—®</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬ä¸‰å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemonize yes                       //å°†noä¿®æ”¹ä¸ºyesï¼Œå¼€å¯å®ˆæŠ¤è¿›ç¨‹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å››å¤„ä¿®æ”¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">requirepass &quot;123456&quot;                   //æ·»åŠ è®¾ç½®è®¿é—®å¯†ç </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬äº”å¤„ä¿®æ”¹ï¼Œè®¾å®šä¸»åº“å¯†ç ä¸å½“å‰åº“å¯†ç åŒæ­¥ï¼Œä¿è¯ä»åº“èƒ½å¤Ÿæå‡ä¸ºä¸»åº“</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">masterauth &quot;123456&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#ç¬¬å…­å¤„ä¿®æ”¹ï¼Œå°†noä¿®æ”¹ä¸ºyesï¼Œæ‰“å¼€AOFæŒä¹…åŒ–æ”¯æŒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">appendonly yes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">auto-aof-rewrite-percentage 0</span><br></span></code></pre></div></div>
<p><strong>é¢˜ç›®3</strong>
ä½¿ç”¨ä¸Šä¸€é¢˜å®‰è£…çš„Redis æœåŠ¡ã€‚åœ¨ Redis ä¸­ï¼ŒAOF é…ç½®ä¸ºä»¥ä¸‰ç§ä¸åŒçš„æ–¹å¼åœ¨ç£ç›˜ä¸Šæ‰§è¡Œ write æˆ–è€… fsyncã€‚å‡è®¾å½“å‰ Redis å‹åŠ›è¿‡å¤§ï¼Œè¯·é…ç½® Redis ä¸æ‰§è¡Œ fsyncã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé¿å…AOF æ–‡ä»¶è¿‡å¤§ï¼ŒRedis ä¼šè¿›è¡Œ AOF é‡å†™ï¼Œç”Ÿæˆç¼©å°çš„ AOF æ–‡ä»¶ã€‚è¯·ä¿®æ”¹é…ç½®ï¼Œè®©AOF é‡å†™æ—¶ï¼Œä¸è¿›è¡Œfsyncæ“ä½œã€‚é…ç½®å®Œæˆåæäº¤ Redis èŠ‚ç‚¹çš„ç”¨æˆ·åã€å¯†ç å’ŒIPåœ°å€åˆ°ç­”é¢˜æ¡†ã€‚</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aof-rewrite_incremental-fsync no</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">no-appendfsync-on-rewrite yes</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">æœ€å<!-- -->äº <b><time datetime="2025-11-29T03:40:16.000Z" itemprop="dateModified">2025å¹´11æœˆ29æ—¥</time></b> <!-- -->æ›´æ–°</span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="æ–‡ä»¶é€‰é¡¹å¡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/study/Kubernetes"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">k8så®¹å™¨ç¼–æ’æŠ€æœ¯</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">
        <div>
          <a href="https://beian.miit.gov.cn" id="beian" target="_blank">è‹ICPå¤‡2024133820å·-1</a>
        </div>
        <div>
          2020 - 2025 MiragEdgeâœ°é”ç•Œå¹»å¢ƒ By F.windEmiko
        </div>
        <div>
          æœ¬ç«™ç”±<a href="https://www.rainyun.com/FwindEmi_" id="yuyun" target="_blank">é›¨äº‘</a>æä¾›è®¡ç®—æœåŠ¡
        </div>
      </div></div></div></footer></div>
</body>
</html>